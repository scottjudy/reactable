---
title: "Examples"
output:
  html_document:
    toc: true
    toc_float:
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(reactable)
```

## Grouping and Aggregation

```{r}
reactable(iris, groupBy = "Species", columns = list(
  Sepal.Length = colDef(aggregate = "count"),
  Sepal.Width = colDef(aggregate = "mean"),
  Petal.Length = colDef(aggregate = "sum"),
  Petal.Width = colDef(aggregate = "max")
))
```

### Multiple Groups

```{r}
reactable(iris, groupBy = c("Species", "Petal.Width"), columns = list(
  Sepal.Length = colDef(
    aggregate = "sum",
    format = list(aggregated = colFormat(suffix = " (total)"))
  ),
  Sepal.Width = colDef(
    aggregate = "mean",
    format = list(aggregated = colFormat(digits = 1, suffix = " (avg)"))
  ),
  Petal.Width = colDef(
    aggregate = "unique"
  ),
  Petal.Length = colDef(
    aggregate = "min",
    format = list(aggregated = colFormat(suffix = " (min)"))
  )
))
```


## Expandable Row Details

#### R render function
```{r}
reactable(iris[1:50, ], details = function(index) {
  htmltools::div(
    "Details for row: ", index,
    htmltools::tags$pre(paste(capture.output(iris[index, ]), collapse = "\n"))
  )
})
```

#### JS render function
```{r}
reactable(iris[1:50, ], details = colDef(
  name = "More",
  details = JS("function(rowInfo) {
    return 'Details for row: ' + rowInfo.index +
      '<pre>' + JSON.stringify(rowInfo, null, 2) + '</pre>'
  }"),
  html = TRUE,
  width = 50
))
```

### Subtables

> NOTE: only supported by R render functions

```{r}
data <- unique(CO2[, c("Plant", "Type")])

reactable(data, details = function(index) {
  subset <- CO2[CO2$Plant == data[index, "Plant"], ]
  htmltools::div(style = "padding: 16px",
    reactable(subset, outlined = TRUE)
  )
})
```

### Conditional row details

> NOTE: only supported by R render functions

```{r}
reactable(iris[1:5, ], details = function(index) {
  if (index %in% c(3, 5)) {
    reactable(data.frame(x = c(1, 2, 3), y = c("a", "b", "c")), inline = TRUE)
  }
})
```

### Multiple row details

```{r}
reactable(iris[1:5, ],
  details = function(index) {
    if (index %in% c(3, 5)) {
      reactable(data.frame(x = c(1, 2, 3), y = c("a", "b", "c")), inline = TRUE)
    }
  },
  columns = list(
    Petal.Length = colDef(details = function(index) {
      paste("Petal.Length: ", iris[index, "Petal.Length"])
    }),
    Sepal.Length = colDef(format = colFormat(digits = 1), details = JS("
      function(rowInfo) {
        return 'Sepal.Length: ' + rowInfo.row['Sepal.Length']
      }
    "))
  )
)
```


## Sorting

### Default sorting

Sort columns by default:

```{r}
reactable(iris, defaultSorted = c("Species", "Petal.Length"))
```

Set default sort order for the table, specific columns, or default sorted columns:

```{r}
reactable(
  iris,
  defaultSortOrder = "desc",
  defaultSorted = list(Sepal.Length = "asc", Petal.Length = "desc"),
  columns = list(
    Species = colDef(defaultSortOrder = "asc")
  )
)
```

> Tip: shift+click to sort multiple columns

### NA and Infinity handling

```{r}
reactable(
  data.frame(
    n = seq(7),
    x = c(5, 7, NA, NaN, 9, 0, -20),
    y = c(1, NA, NA, -Inf, 0, Inf, -5)
  ),
  columns = list(
    y = colDef(na = "NA")
  )
)
```

### Always sort NAs to the bottom

```{r}
reactable(
  data.frame(
    n = c(1, 2, 3, 4, 5),
    x = c(2, 3, 1, NA, NA),
    y = c("aa", "cc", "bb", NA, NA)
  ),
  defaultColDef = colDef(sortMethod = "naLast"),
  defaultSorted = "x"
)
```

### Show sortable columns

```{r}
reactable(iris[1:50, ], sortable = FALSE, showSortable = TRUE, columns = list(
  Petal.Width = colDef(sortable = TRUE),
  Petal.Length = colDef(sortable = TRUE)
))
```


## Filtering

```{r}
reactable(iris, filterable = TRUE)
```

```{r}
data <- data.frame(
  city = c("Hà N\u1ed9i", "Zürich", "Saint-Étienne", "São Gonçalo"),
  country = c("Vietnam", "Switzerland", "France", "Brazil"),
  area = c(3328.9, 87.88, 79.97, 249.142),
  capital = c(TRUE, FALSE, FALSE, FALSE),
  stringsAsFactors = FALSE
)

reactable(data, filterable = TRUE)
```


## Column Groups

```{r}
reactable(
  iris[1:50, ],
  colnames = list(
    Sepal.Length = "Length",
    Sepal.Width = "Width",
    Petal.Length = "Length",
    Petal.Width = "Width"
  ),
  columnGroups = list(
    colGroup(name = "Sepal", columns = c("Sepal.Length", "Sepal.Width")),
    colGroup(name = "Petal", columns = c("Petal.Length", "Petal.Width"))
  )
)
```


## Column Formatting

```{r}
data <- data.frame(
  price_USD = c(123456.56, 132, 5650.12),
  price_INR = c(350, 23208.552, 1773156.4),
  temp = c(22, NA, 31),
  percent = c(0.9525556, 0.5, 0.112),
  date = as.Date(c("2019-01-02", "2019-03-15", "2019-09-22"))
)

reactable(data, columns = list(
  price_USD = colDef(format = colFormat(prefix = "$", separators = TRUE, digits = 2)),
  price_INR = colDef(format = colFormat(currency = "INR", separators = TRUE, locale = "hi-IN")),
  temp = colDef(format = colFormat(suffix = " °C")),
  percent = colDef(format = colFormat(percent = TRUE, digits = 1)),
  date = colDef(format = colFormat(date = TRUE, locale = "en-GB"))
))
```

### Formatting aggregated cells

```{r}
data <- data.frame(
  States = state.name,
  Region = state.region,
  Area = state.area
)

reactable(data, groupBy = "Region", columns = list(
  States = colDef(
    aggregate = "count",
    format = list(
      aggregated = colFormat(suffix = " states")
    )
  ),
  Area = colDef(
    aggregate = "sum",
    format = colFormat(suffix = " mi²", separators = TRUE)
  )
))
```

### Date Formatting

```{r}
datetimes <- as.POSIXct(c("2019-01-02 3:22:15", "2019-03-15 09:15:55", "2019-09-22 14:20:00"))
data <- data.frame(
  datetime = datetimes,
  date = datetimes,
  time = datetimes,
  time_24h = datetimes,
  datetime_pt_BR = datetimes
)

reactable(data, columns = list(
  datetime = colDef(format = colFormat(datetime = TRUE)),
  date = colDef(format = colFormat(date = TRUE)),
  time = colDef(format = colFormat(time = TRUE)),
  time_24h = colDef(format = colFormat(time = TRUE, hour12 = FALSE)),
  datetime_pt_BR = colDef(format = colFormat(datetime = TRUE, locales = "pt-BR"))
))
```

### Currency Formatting

```{r}
data <- data.frame(
  USD = c(12.12, 2141.213, 0.42, 1.55, 34414),
  EUR = c(10.68, 1884.27, 0.37, 1.36, 30284.32),
  INR = c(861.07, 152122.48, 29.84, 110, 2444942.63),
  JPY = c(1280, 226144, 44.36, 164, 3634634.61),
  MAD = c(115.78, 20453.94, 4.01, 15, 328739.73)
)

reactable(data, columns = list(
  USD = colDef(
    format = colFormat(currency = "USD", separators = TRUE, locale = "en-US")
  ),
  EUR = colDef(
    format = colFormat(currency = "EUR", separators = TRUE, locale = "de-DE")
  ),
  INR = colDef(
    format = colFormat(currency = "INR", separators = TRUE, locale = "hi-IN")
  ),
  JPY = colDef(
    format = colFormat(currency = "JPY", separators = TRUE, locale = "ja-JP")
  ),
  MAD = colDef(
    format = colFormat(currency = "MAD", separators = TRUE, locale = "ar-MA")
  )
))
```


## Cell Renderers

#### R render function
```{r}
data <- MASS::Cars93[, c("Manufacturer", "Model", "Type", "AirBags", "Price")]

reactable(data, columns = list(
  Model = colDef(cell = function(value, index) {
    # Render as a link
    url <- sprintf("https://wikipedia.org/wiki/%s_%s", data[index, "Manufacturer"], value)
    htmltools::tags$a(href = url, target = "_blank", as.character(value))
  }),
  AirBags = colDef(cell = function(value) {
    # Render as ✘ or ✓
    if (value == "None") "\u2718" else "\u2713"
  }),
  Price = colDef(cell = function(value) {
    # Render as currency
    paste0("$", format(value * 1000, big.mark = ","))
  })
))
```

#### JS render function
```{r}
data <- MASS::Cars93[, c("Manufacturer", "Model", "Type", "AirBags", "Price")]

reactable(data, columns = list(
  Model = colDef(html = TRUE, cell = JS("
    function(cellInfo) {
      // Render as a link
      var url = 'https://wikipedia.org/wiki/' + cellInfo.row.Manufacturer + '_' + cellInfo.value
      return '<a href=\"' + url + '\" target=\"_blank\">' + cellInfo.value + '</a>'
    }
  ")),
  AirBags = colDef(cell = JS("
    function(cellInfo) {
      // Render as ✘ or ✓ 
      return cellInfo.value === 'None' ? '\u2718' : '\u2713'
    }
  ")),
  Price = colDef(cell = JS("
    function(cellInfo) {
      // Render as currency
      return '$' + (cellInfo.value * 1000).toLocaleString()
    }
  "))
))
```

### Aggregated cells

```{r}
data <- MASS::Cars93[, c("Manufacturer", "Model", "Type", "Price")]

reactable(data, groupBy = "Manufacturer", columns = list(
  Model = colDef(name = "Models", aggregate = "count"),
  Type = colDef(aggregate = "unique"),
  Price = colDef(align = "left", html = TRUE, aggregate = "mean", aggregated = JS("
    function(cellInfo) {
      var value = '$' + Math.round(cellInfo.value * 1000).toLocaleString()
      return '<span style=\"margin-right: 4px; color: #999\">Avg</span> ' + value
    }
  "))
))
```


## Embedding HTML Widgets

```{r message=FALSE}
library(dplyr)
library(sparkline)

data <- chickwts %>%
  group_by(feed) %>%
  summarise(weight = list(weight)) %>%
  mutate(boxplot = NA, sparkline = NA)

reactable(data, highlight = FALSE, columns = list(
  weight = colDef(cell = function(values) {
    sparkline(values, type = "bar")
  }),
  boxplot = colDef(cell = function(value, index) {
    sparkline(data$weight[[index]], type = "box")
  }),
  sparkline = colDef(cell = function(value, index) {
    sparkline(data$weight[[index]])
  })
))
```


## Conditional Styling

### Cell styling
```{r}
reactable(sleep, columns = list(
  extra = colDef(style = function(value) {
    if (value > 0) {
      color <- "green"
    } else if (value < 0) {
      color <- "red"
    } else {
      color <- "#777"
    }
    list(color = color, fontWeight = "bold")
  })
))
```

```{r}
reactable(sleep, columns = list(
  extra = colDef(style = JS("
    function(rowInfo) {
      var value = rowInfo.row.extra
      if (value > 0) {
        var color = 'green'
      } else if (value < 0) {
        var color = 'red'
      } else {
        var color = '#777'
      }
      return { color: color, fontWeight: 'bold' }
    }
  "))
))
```

### Row styling
```{r row_styling, eval=FALSE}
reactable(sleep, 
  rowStyle = function(index) {
    if (sleep[index, "extra"] < -1) {
      list(backgroundColor = "#ffd08a")
    }
  },
  rowClass = function(index) {
    if (sleep[index, "extra"] < -1) {
      "bold"
    }
  }
)
```

```{css}
.bold {
  font-weight: bold;
}
```

```{r ref.label="row_styling", echo=FALSE}
```

```{r}
reactable(sleep,
  rowStyle = JS("function(rowInfo) {
    if (rowInfo.row.extra < -1) {
      return { backgroundColor: '#ffd08a' }
    }
  }"),
  rowClass = JS("function(rowInfo) {
    if (rowInfo.row.extra < -1) {
      return 'bold'
    }
  }")
)
```


## Footers

```{r}
reactable(iris[1:50, ], columns = list(
  Sepal.Length = colDef(
    footer = paste("Avg:", round(mean(iris$Sepal.Length), 1))
  ),
  Sepal.Width = colDef(footer = function(values, key) {
    htmltools::span(htmltools::tags$b("Total: "), sum(values))
  }),
  Petal.Length = colDef(html = TRUE, footer = JS("
    function(colInfo) {
      return '<b>Rows: </b>' + colInfo.data.length
    }
  "))
))
```


## Table Styles

### Default

```{r}
reactable(iris[1:5, ])
```

### Bordered

```{r}
reactable(iris[1:5, ], bordered = TRUE)
```

### Borderless

```{r}
reactable(iris[1:5, ], borderless = TRUE)
```

### Outlined

```{r}
reactable(iris[1:5, ], outlined = TRUE)
```

### Striped

```{r}
reactable(iris[1:5, ], striped = TRUE)
```

### Bordered + striped

```{r}
reactable(iris[1:5, ], bordered = TRUE, striped = TRUE)
```

### Outlined + borderless

```{r}
reactable(iris[1:5, ], outlined = TRUE, borderless = TRUE)
```

### Compact

```{r}
reactable(iris[1:5, ], compact = TRUE)
```


## Pagination

### Page size options
```{r}
reactable(iris[1:50, ], defaultPageSize = 4, pageSizeOptions = c(4, 8, 12))
```

### Alternative pagination types

#### Page jump
```{r}
reactable(iris[1:50, ], paginationType = "jump", defaultPageSize = 4)
```

#### Simple
```{r}
reactable(iris[1:50, ], paginationType = "simple", defaultPageSize = 4)
```

### Hide pagination elements
```{r}
reactable(iris[1:50, ], showPageSizeOptions = FALSE, defaultPageSize = 4)
reactable(iris[1:50, ], showPageInfo = FALSE, defaultPageSize = 4)
```

### Minimum rows per page
```{r}
reactable(iris[1:6, ], defaultPageSize = 4, minRows = 4)
```

### No pagination
```{r}
reactable(iris[1:50, ], pagination = FALSE, height = 300)
```

```{css echo=FALSE}
/* rmarkdown html documents */
.main-container {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
}

.main-container blockquote {
  font-size: inherit;
}

/* pkgdown articles */
.contents {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
}

.contents blockquote {
  font-size: inherit;
}

.ReactTable {
  font-size: 14px;
}
```
