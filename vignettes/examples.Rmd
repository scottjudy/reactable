---
title: "Examples"
output:
  html_document:
    toc: true
    toc_float:
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(reactable)
```

## Grouping and Aggregation

```{r}
reactable(iris, groupBy = "Species", columns = list(
  Sepal.Length = colDef(aggregate = "count"),
  Sepal.Width = colDef(aggregate = "mean"),
  Petal.Length = colDef(aggregate = "sum"),
  Petal.Width = colDef(aggregate = "max")
))
```

### Multiple Groups

```{r}
reactable(iris, groupBy = c("Species", "Petal.Width"), columns = list(
  Sepal.Length = colDef(
    aggregate = "sum",
    format = list(aggregated = colFormat(suffix = " (total)"))
  ),
  Sepal.Width = colDef(
    aggregate = "mean",
    format = list(aggregated = colFormat(digits = 1, suffix = " (avg)"))
  ),
  Petal.Width = colDef(
    aggregate = "unique"
  ),
  Petal.Length = colDef(
    aggregate = "min",
    format = list(aggregated = colFormat(suffix = " (min)"))
  )
))
```


## Expandable Row Details

#### R render function
```{r}
reactable(iris, details = function(index) {
  htmltools::div(
    "Details for row: ", index,
    htmltools::tags$pre(paste(capture.output(iris[index, ]), collapse = "\n"))
  )
})
```

#### JS render function
```{r}
reactable(iris, details = colDef(
  name = "More",
  details = JS("
    function(rowInfo) {
      return 'Details for row: ' + rowInfo.index +
        '<pre>' + JSON.stringify(rowInfo, null, 2) + '</pre>'
    }
  "),
  html = TRUE,
  width = 50
))
```

### Subtables

> NOTE: only supported by R render functions

```{r}
data <- unique(CO2[, c("Plant", "Type")])

reactable(data, details = function(index) {
  subset <- CO2[CO2$Plant == data[index, "Plant"], ]
  htmltools::div(style = "padding: 16px",
    reactable(subset, outlined = TRUE)
  )
})
```

### Conditional row details

> NOTE: only supported by R render functions

```{r}
reactable(head(iris, 10), details = function(index) {
  if (index %in% c(3, 5)) {
    reactable(data.frame(x = c(1, 2, 3), y = c("a", "b", "c")), inline = TRUE)
  }
})
```

### Multiple row details

```{r}
reactable(head(iris, 10), 
  details = function(index) {
    if (index %in% c(3, 5)) {
      reactable(data.frame(x = c(1, 2, 3), y = c("a", "b", "c")), inline = TRUE)
    }
  },
  columns = list(
    Petal.Length = colDef(details = function(index) {
      paste("Petal.Length: ", iris[index, "Petal.Length"])
    }),
    Sepal.Length = colDef(format = colFormat(digits = 1), details = JS("
      function(rowInfo) {
        return 'Sepal.Length: ' + rowInfo.row['Sepal.Length']
      }
    "))
  )
)
```


## Sorting

### Default sorting

Sort columns by default:

```{r}
reactable(iris, defaultSorted = c("Species", "Petal.Length"))
```

Set default sort order for the table, specific columns, or default sorted columns:

```{r}
reactable(
  iris,
  defaultSortOrder = "desc",
  defaultSorted = list(Sepal.Length = "asc", Petal.Length = "desc"),
  columns = list(
    Species = colDef(defaultSortOrder = "asc")
  )
)
```

> Tip: shift+click to sort multiple columns

### NA and Infinity handling

```{r}
reactable(
  data.frame(
    n = seq(7),
    x = c(5, 7, NA, NaN, 9, 0, -20),
    y = c(1, NA, NA, -Inf, 0, Inf, -5)
  ),
  columns = list(
    x = colDef(showNA = TRUE)
  )
)
```

### Always sort NAs to the bottom

```{r}
reactable(
  data.frame(
    n = c(1, 2, 3, 4, 5),
    x = c(2, 3, 1, NA, NA),
    y = c(4, 5, 6, NA, NA)
  ),
  defaultColDef = colDef(sortMethod = "naLast"),
  defaultSorted = "x"
)
```

### Show sortable columns

```{r}
reactable(iris, sortable = FALSE, showSortable = TRUE, columns = list(
  Petal.Width = colDef(sortable = TRUE),
  Petal.Length = colDef(sortable = TRUE)
))
```


## Filtering

```{r}
reactable(iris, filterable = TRUE)
```

```{r}
data <- data.frame(
  city = c("Hà N\u1ed9i", "Zürich", "Saint-Étienne", "São Gonçalo"),
  country = c("Vietnam", "Switzerland", "France", "Brazil"),
  area = c(3328.9, 87.88, 79.97, 249.142),
  capital = c(TRUE, FALSE, FALSE, FALSE),
  stringsAsFactors = FALSE
)

reactable(data, filterable = TRUE)
```


## Column Groups

```{r}
reactable(
  iris,
  columns = list(
    Sepal.Length = colDef(name = "Length"),
    Sepal.Width = colDef(name = "Width"),
    Petal.Length = colDef(name = "Length"),
    Petal.Width = colDef(name = "Width")
  ),
  columnGroups = list(
    colGroup(name = "Sepal", columns = c("Sepal.Length", "Sepal.Width")),
    colGroup(name = "Petal", columns = c("Petal.Length", "Petal.Width"))
  )
)
```


## Column Formatting

```{r}
reactable(iris, groupBy = "Species", columns = list(
  Sepal.Length = colDef(
    aggregate = "sum",
    format = colFormat(suffix = " cm")
  ),
  Sepal.Width = colDef(
    aggregate = "mean",
    format = list(aggregated = colFormat(suffix = " (avg)", digits = 2))
  )
))
```

### Date Formatting

```{r}
datetimes <- as.POSIXct(c("2019-01-02 3:22:15", "2019-03-15 09:15:55", "2019-09-22 14:20:00"))
data <- data.frame(
  datetime = datetimes,
  date = datetimes,
  time = datetimes,
  time_24h = datetimes,
  datetime_pt_BR = datetimes
)

reactable(data, columns = list(
  datetime = colDef(format = colFormat(datetime = TRUE)),
  date = colDef(format = colFormat(date = TRUE)),
  time = colDef(format = colFormat(time = TRUE)),
  time_24h = colDef(format = colFormat(time = TRUE, hour12 = FALSE)),
  datetime_pt_BR = colDef(format = colFormat(datetime = TRUE, locales = "pt-BR"))
))
```

### Currency Formatting

```{r}
data <- data.frame(
  item = letters[1:6],
  qty = c(12000, 300.15, 3535125, 0, 4344, 12),
  price_usd = c(12.12, 2141.213, 0.42, NA, 1.55, 34414),
  price_eur = c(10.68, 1884.27, 0.37, NA, 1.36, 30284.32),
  price_inr = c(841.73, 148707.24, 29, NA, 107.65, 2390052.3)
)

reactable(data, columns = list(
  qty = colDef(
    format = colFormat(separators = TRUE)
  ),
  price_usd = colDef(
    name = "USD",
    format = colFormat(currency = "USD", separators = TRUE)
  ),
  price_eur = colDef(
    name = "EUR",
    format = colFormat(currency = "EUR", separators = TRUE, locale = "de-DE")
  ),
  price_inr = colDef(
    name = "INR",
    format = colFormat(currency = "INR", separators = TRUE, locale = "hi-IN")
  )
))
```


## Cell Renderers

#### R render function
```{r}
data <- MASS::Cars93[, c("Manufacturer", "Model", "Type", "AirBags", "Price")]

reactable(data, columns = list(
  Model = colDef(cell = function(value, index) {
    # Render as a link
    url <- sprintf("https://wikipedia.org/wiki/%s_%s", data[index, "Manufacturer"], value)
    htmltools::tags$a(href = url, target = "_blank", as.character(value))
  }),
  AirBags = colDef(cell = function(value) {
    # Render as ✘ or ✓
    if (value == "None") "\u2718" else "\u2713"
  }),
  Price = colDef(cell = function(value) {
    # Render as currency
    paste0("$", format(value * 1000, big.mark = ","))
  })
))
```

#### JS render function
```{r}
data <- MASS::Cars93[, c("Manufacturer", "Model", "Type", "AirBags", "Price")]

reactable(data, columns = list(
  Model = colDef(html = TRUE, cell = JS("
    function(cellInfo) {
      var url = 'https://wikipedia.org/wiki/' + cellInfo.row.Manufacturer + '_' + cellInfo.value
      return '<a href=\"' + url + '\" target=\"_blank\">' + cellInfo.value + '</a>'
    }
  ")),
  AirBags = colDef(cell = JS("
    function(cellInfo) {
      return cellInfo.value === 'None' ? '\u2718' : '\u2713'
    }
  ")),
  Price = colDef(cell = JS("
    function(cellInfo) {
      return '$' + (cellInfo.value * 1000).toLocaleString()
    }
  "))
))
```

### Aggregated cells

```{r}
data <- MASS::Cars93[, c("Manufacturer", "Model", "Type", "Price")]

reactable(data, groupBy = "Manufacturer", columns = list(
  Model = colDef(name = "Models", aggregate = "count"),
  Type = colDef(aggregate = "unique"),
  Price = colDef(align = "left", html = TRUE, aggregate = "mean", aggregated = JS("
    function(cellInfo) {
      var value = '$' + Math.round(cellInfo.value * 1000).toLocaleString()
      return '<span style=\"margin-right: 4px; color: #999\">Avg</span> ' + value
    }
  "))
))
```


## Conditional Styling

### Cell styling
```{r}
reactable(datasets::sleep, columns = list(
  extra = colDef(style = function(value) {
    if (value > 0) {
      color <- "green"
    } else if (value < 0) {
      color <- "red"
    } else {
      color <- "#777"
    }
    list(color = color, fontWeight = "bold")
  })
))
```

```{r}
reactable(datasets::sleep, columns = list(
  extra = colDef(style = JS("
    function(rowInfo) {
      var value = rowInfo.row.extra
      if (value > 0) {
        var color = 'green'
      } else if (value < 0) {
        var color = 'red'
      } else {
        var color = '#777'
      }
      return { color: color, fontWeight: 'bold' }
    }
  "))
))
```

### Row styling
```{r row_styling, eval=FALSE}
reactable(datasets::sleep, 
  rowStyle = function(index) {
    if (sleep[index, "extra"] < -1) {
      list(backgroundColor = "#ffd08a")
    }
  },
  rowClass = function(index) {
    if (sleep[index, "extra"] < -1) {
      "bold"
    }
  }
)
```

```{css}
.bold {
  font-weight: bold;
}
```

```{r ref.label="row_styling", echo=FALSE}
```

```{r}
reactable(datasets::sleep,
  rowStyle = JS("
    function(rowInfo) {
      if (rowInfo.row.extra < -1) {
        return { backgroundColor: '#ffd08a' }
      }
    }
  "),
  rowClass = JS("
    function(rowInfo) {
      if (rowInfo.row.extra < -1) {
        return 'bold'
      }
    }
  ")
)
```


## Footers

```{r}
reactable(iris, columns = list(
  Sepal.Length = colDef(
    footer = paste("Avg:", round(mean(iris$Sepal.Length), 1))
  ),
  Sepal.Width = colDef(footer = function(values, key) {
    htmltools::span(htmltools::tags$b("Total: "), sum(values))
  }),
  Petal.Length = colDef(html = TRUE, footer = JS("
    function(colInfo) {
      return '<b>Rows: </b>' + colInfo.data.length
    }
  "))
))
```


## Table Styles

### Default

```{r}
reactable(iris[1:5, ])
```

### Bordered

```{r}
reactable(iris[1:5, ], bordered = TRUE)
```

### Borderless

```{r}
reactable(iris[1:5, ], borderless = TRUE)
```

### Outlined

```{r}
reactable(iris[1:5, ], outlined = TRUE)
```

### Striped

```{r}
reactable(iris[1:5, ], striped = TRUE)
```

### Bordered + striped

```{r}
reactable(iris[1:5, ], bordered = TRUE, striped = TRUE)
```

### Outlined + borderless

```{r}
reactable(iris[1:5, ], outlined = TRUE, borderless = TRUE)
```

### Compact

```{r}
reactable(iris[1:5, ], compact = TRUE)
```


## Pagination

### Page size options
```{r}
reactable(iris, defaultPageSize = 4, pageSizeOptions = c(4, 8, 12))
```

### Alternative pagination types

#### Page jump
```{r}
reactable(iris, paginationType = "jump", defaultPageSize = 4)
```

#### Simple
```{r}
reactable(iris, paginationType = "simple", defaultPageSize = 4)
```

### Hide pagination elements
```{r}
reactable(iris, showPageSizeOptions = FALSE, defaultPageSize = 4)
reactable(iris, showPageInfo = FALSE, defaultPageSize = 4)
```

```{css echo=FALSE}
/* rmarkdown html documents */
.main-container {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
}

.main-container blockquote {
  font-size: inherit;
}

/* pkgdown articles */
.contents {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
}

.contents blockquote {
  font-size: inherit;
}

.ReactTable {
  font-size: 14px;
}
```
